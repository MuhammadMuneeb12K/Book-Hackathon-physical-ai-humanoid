<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-module-3/navigation-nav2-humanoids" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">3.4 Navigation with Nav2 for Humanoids | Humanoid Robotics Book</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://muhammadmuneeb12k.github.io/Book-Hackathon-physical-ai-humanoid/module-3/navigation-nav2-humanoids/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="3.4 Navigation with Nav2 for Humanoids | Humanoid Robotics Book"><meta data-rh="true" name="description" content="Having equipped our humanoid robot with the ability to perceive its environment and localize itself through VSLAM, the next logical step is to enable it to move autonomously. This chapter focuses on navigation, specifically using Nav2 – the powerful ROS 2 navigation stack – tailored for humanoid robots. Nav2 provides a robust framework for global and local path planning, obstacle avoidance, and executive control, allowing simulated humanoid robots to navigate complex environments intelligently and safely."><meta data-rh="true" property="og:description" content="Having equipped our humanoid robot with the ability to perceive its environment and localize itself through VSLAM, the next logical step is to enable it to move autonomously. This chapter focuses on navigation, specifically using Nav2 – the powerful ROS 2 navigation stack – tailored for humanoid robots. Nav2 provides a robust framework for global and local path planning, obstacle avoidance, and executive control, allowing simulated humanoid robots to navigate complex environments intelligently and safely."><link data-rh="true" rel="icon" href="/Book-Hackathon-physical-ai-humanoid/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://muhammadmuneeb12k.github.io/Book-Hackathon-physical-ai-humanoid/module-3/navigation-nav2-humanoids/"><link data-rh="true" rel="alternate" href="https://muhammadmuneeb12k.github.io/Book-Hackathon-physical-ai-humanoid/module-3/navigation-nav2-humanoids/" hreflang="en"><link data-rh="true" rel="alternate" href="https://muhammadmuneeb12k.github.io/Book-Hackathon-physical-ai-humanoid/module-3/navigation-nav2-humanoids/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Module 3: Humanoid Robot Dynamics","item":"https://muhammadmuneeb12k.github.io/Book-Hackathon-physical-ai-humanoid/category/module-3-humanoid-robot-dynamics"},{"@type":"ListItem","position":2,"name":"3.4 Navigation with Nav2 for Humanoids","item":"https://muhammadmuneeb12k.github.io/Book-Hackathon-physical-ai-humanoid/module-3/navigation-nav2-humanoids"}]}</script><link rel="stylesheet" href="/Book-Hackathon-physical-ai-humanoid/assets/css/styles.43713d77.css">
<script src="/Book-Hackathon-physical-ai-humanoid/assets/js/runtime~main.1ded580c.js" defer="defer"></script>
<script src="/Book-Hackathon-physical-ai-humanoid/assets/js/main.66668575.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><a class="navbar__brand" href="/Book-Hackathon-physical-ai-humanoid/"></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/Book-Hackathon-physical-ai-humanoid/category/module-1-the-robotic-nervous-system-ros-2/"><span title="Module 1: The Robotic Nervous System (ROS 2)" class="categoryLinkLabel_W154">Module 1: The Robotic Nervous System (ROS 2)</span></a><button aria-label="Expand sidebar category &#x27;Module 1: The Robotic Nervous System (ROS 2)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/Book-Hackathon-physical-ai-humanoid/category/module-2-humanoid-robot-kinematics/"><span title="Module 2: Humanoid Robot Kinematics" class="categoryLinkLabel_W154">Module 2: Humanoid Robot Kinematics</span></a><button aria-label="Expand sidebar category &#x27;Module 2: Humanoid Robot Kinematics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/Book-Hackathon-physical-ai-humanoid/category/module-3-humanoid-robot-dynamics/"><span title="Module 3: Humanoid Robot Dynamics" class="categoryLinkLabel_W154">Module 3: Humanoid Robot Dynamics</span></a><button aria-label="Collapse sidebar category &#x27;Module 3: Humanoid Robot Dynamics&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Book-Hackathon-physical-ai-humanoid/module-3/introduction-isaac-sim/"><span title="3.1 Introduction to NVIDIA Isaac Sim" class="linkLabel_WmDU">3.1 Introduction to NVIDIA Isaac Sim</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Book-Hackathon-physical-ai-humanoid/module-3/synthetic-data-domain-randomization/"><span title="3.2 Synthetic Data &amp; Domain Randomization" class="linkLabel_WmDU">3.2 Synthetic Data &amp; Domain Randomization</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Book-Hackathon-physical-ai-humanoid/module-3/perception-isaac-ros-vslam/"><span title="3.3 Perception with Isaac ROS (VSLAM)" class="linkLabel_WmDU">3.3 Perception with Isaac ROS (VSLAM)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Book-Hackathon-physical-ai-humanoid/module-3/navigation-nav2-humanoids/"><span title="3.4 Navigation with Nav2 for Humanoids" class="linkLabel_WmDU">3.4 Navigation with Nav2 for Humanoids</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Book-Hackathon-physical-ai-humanoid/module-3/training-robot-policies/"><span title="3.5 Training Robot Policies" class="linkLabel_WmDU">3.5 Training Robot Policies</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/Book-Hackathon-physical-ai-humanoid/category/module-4-humanoid-robot-control/"><span title="Module 4: Humanoid Robot Control" class="categoryLinkLabel_W154">Module 4: Humanoid Robot Control</span></a><button aria-label="Expand sidebar category &#x27;Module 4: Humanoid Robot Control&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/Book-Hackathon-physical-ai-humanoid/category/miscellaneous/"><span title="Miscellaneous" class="categoryLinkLabel_W154">Miscellaneous</span></a><button aria-label="Expand sidebar category &#x27;Miscellaneous&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Book-Hackathon-physical-ai-humanoid/appendices/"><span title="7.1 Appendices - Resources and Further Reading" class="linkLabel_WmDU">7.1 Appendices - Resources and Further Reading</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/Book-Hackathon-physical-ai-humanoid/capstone/capstone-integration-guide/"><span title="capstone" class="categoryLinkLabel_W154">capstone</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Book-Hackathon-physical-ai-humanoid/getting-started/"><span title="Getting Started - Setting Up Your Environment" class="linkLabel_WmDU">Getting Started - Setting Up Your Environment</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Book-Hackathon-physical-ai-humanoid/hardware-lab-setup/"><span title="6.1 Hardware &amp; Lab Setup - Beyond Simulation" class="linkLabel_WmDU">6.1 Hardware &amp; Lab Setup - Beyond Simulation</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/Book-Hackathon-physical-ai-humanoid/home/overview/"><span title="home" class="categoryLinkLabel_W154">home</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Book-Hackathon-physical-ai-humanoid/"><span title="Welcome to the Humanoid Robotics Book" class="linkLabel_WmDU">Welcome to the Humanoid Robotics Book</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/Book-Hackathon-physical-ai-humanoid/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/Book-Hackathon-physical-ai-humanoid/category/module-3-humanoid-robot-dynamics/"><span>Module 3: Humanoid Robot Dynamics</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">3.4 Navigation with Nav2 for Humanoids</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>3.4 Navigation with Nav2 for Humanoids</h1></header><p>Having equipped our humanoid robot with the ability to perceive its environment and localize itself through VSLAM, the next logical step is to enable it to move autonomously. This chapter focuses on navigation, specifically using Nav2 – the powerful ROS 2 navigation stack – tailored for humanoid robots. Nav2 provides a robust framework for global and local path planning, obstacle avoidance, and executive control, allowing simulated humanoid robots to navigate complex environments intelligently and safely.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="goal">Goal<a href="#goal" class="hash-link" aria-label="Direct link to Goal" title="Direct link to Goal" translate="no">​</a></h2>
<p>The goal of this chapter is to teach students how to use Nav2 for humanoid robot path planning, allowing simulated humanoid robots to navigate complex environments autonomously within Isaac Sim, building upon VSLAM for localization and mapping.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="learning-objectives">Learning Objectives<a href="#learning-objectives" class="hash-link" aria-label="Direct link to Learning Objectives" title="Direct link to Learning Objectives" translate="no">​</a></h2>
<ul>
<li class="">Understand the modular architecture of the Nav2 stack and its key components.</li>
<li class="">Differentiate between global and local planning strategies for robot navigation.</li>
<li class="">Learn how to configure Nav2 for a humanoid robot, considering its unique locomotion challenges.</li>
<li class="">Integrate Nav2 with VSLAM outputs for accurate localization and map updates.</li>
<li class="">Implement a full navigation pipeline: from setting a goal to autonomous movement.</li>
<li class="">Visualize Nav2&#x27;s planning output (global/local paths, costmaps) in RViz2.</li>
<li class="">Troubleshoot common navigation issues and tune Nav2 parameters for optimal performance.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites" translate="no">​</a></h2>
<ul>
<li class="">Familiarity with ROS 2 concepts (nodes, topics, services, actions, parameters).</li>
<li class="">Understanding of TF2 (coordinate frames and transformations).</li>
<li class="">Knowledge of VSLAM for localization and mapping (from the previous chapter).</li>
<li class="">A simulated humanoid robot in Isaac Sim capable of receiving joint commands for movement (e.g., from Module 1, Lab 1.2.2).</li>
<li class="">A pre-built map of the environment (e.g., from VSLAM or a static map).</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="key-concepts">Key Concepts<a href="#key-concepts" class="hash-link" aria-label="Direct link to Key Concepts" title="Direct link to Key Concepts" translate="no">​</a></h2>
<ul>
<li class=""><strong>Nav2:</strong> The ROS 2 Navigation Stack, a collection of modular packages for autonomous mobile robot navigation.</li>
<li class=""><strong>Global Planner:</strong> Generates a long-term, collision-free path from the robot&#x27;s current location to a goal location, typically based on a static map.</li>
<li class=""><strong>Local Planner (Controller):</strong> Generates short-term, velocity commands to follow the global path and avoid dynamic obstacles.</li>
<li class=""><strong>Costmap:</strong> A grid-based representation of the environment, where each cell contains a cost associated with traversing it (e.g., obstacles, unknown areas). Nav2 uses global and local costmaps.</li>
<li class=""><strong>Localization:</strong> Determining the robot&#x27;s precise position and orientation within a map. Nav2 relies on external localization sources (e.g., VSLAM, AMCL).</li>
<li class=""><strong>Waypoint Navigation:</strong> Guiding the robot through a sequence of predefined points.</li>
<li class=""><strong>Recovery Behaviors:</strong> Strategies Nav2 employs to escape difficult situations (e.g., getting stuck, blocked by an obstacle).</li>
<li class=""><strong><code>nav_to_pose</code> Action:</strong> The primary ROS 2 action for sending navigation goals to Nav2.</li>
<li class=""><strong><code>robot_localization</code>:</strong> A meta-package in ROS 2 that provides sensor fusion for accurate state estimation (combining IMU, odometry, VSLAM outputs).</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="tools">Tools<a href="#tools" class="hash-link" aria-label="Direct link to Tools" title="Direct link to Tools" translate="no">​</a></h2>
<ul>
<li class=""><strong>NVIDIA Isaac Sim:</strong> Simulated environment and humanoid robot.</li>
<li class=""><strong>ROS 2 Humble:</strong> The robotic framework.</li>
<li class=""><strong>Nav2 Stack:</strong> The core navigation packages (e.g., <code>nav2_bringup</code>, <code>nav2_planner</code>, <code>nav2_controller</code>, <code>nav2_bt_navigator</code>).</li>
<li class=""><strong>RViz2:</strong> For visualizing the robot, map, costmaps, and planned paths.</li>
<li class=""><strong><code>robot_localization</code>:</strong> For fusing sensor data (optional, but highly recommended).</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="chapter-sections">Chapter Sections<a href="#chapter-sections" class="hash-link" aria-label="Direct link to Chapter Sections" title="Direct link to Chapter Sections" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="341-overview-of-the-nav2-navigation-stack">3.4.1 Overview of the Nav2 Navigation Stack<a href="#341-overview-of-the-nav2-navigation-stack" class="hash-link" aria-label="Direct link to 3.4.1 Overview of the Nav2 Navigation Stack" title="Direct link to 3.4.1 Overview of the Nav2 Navigation Stack" translate="no">​</a></h3>
<ul>
<li class="">Modular architecture: separation of concerns (global plan, local plan, recovery, localization).</li>
<li class="">Key nodes: <code>planner_server</code>, <code>controller_server</code>, <code>smoother_server</code>, <code>behavior_tree_navigator</code>, <code>bt_navigator</code>.</li>
<li class="">Data flow: map, localization estimate, goal -&gt; planner -&gt; controller -&gt; robot commands.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="342-global-planning-finding-the-route">3.4.2 Global Planning: Finding the Route<a href="#342-global-planning-finding-the-route" class="hash-link" aria-label="Direct link to 3.4.2 Global Planning: Finding the Route" title="Direct link to 3.4.2 Global Planning: Finding the Route" translate="no">​</a></h3>
<ul>
<li class=""><strong>Global Planners:</strong> e.g., <code>NavFn</code>, <code>Dijkstra</code>, <code>A*</code>, <code>SmacPlanner</code>.</li>
<li class=""><strong>Map Representation:</strong> Nav2&#x27;s global costmap.</li>
<li class=""><strong>Path Generation:</strong> Calculating the shortest/optimal path while avoiding known obstacles.</li>
<li class=""><strong>Configuring Global Planner Parameters:</strong> Customizing obstacle inflation, resolution, etc.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="343-local-planning-following-the-path-and-avoiding-obstacles">3.4.3 Local Planning: Following the Path and Avoiding Obstacles<a href="#343-local-planning-following-the-path-and-avoiding-obstacles" class="hash-link" aria-label="Direct link to 3.4.3 Local Planning: Following the Path and Avoiding Obstacles" title="Direct link to 3.4.3 Local Planning: Following the Path and Avoiding Obstacles" translate="no">​</a></h3>
<ul>
<li class=""><strong>Local Planners (Controllers):</strong> e.g., <code>DWBController</code> (Dynamic Window Bounding), <code>TEBController</code> (Timed-Elastic Band).</li>
<li class=""><strong>Local Costmap:</strong> Dynamic obstacle detection from real-time sensor data.</li>
<li class=""><strong>Trajectory Generation:</strong> Creating a short-term, dynamically feasible path.</li>
<li class=""><strong>Velocity Commands:</strong> Outputting <code>geometry_msgs/msg/Twist</code> messages for robot actuation.</li>
<li class=""><strong>Configuring Local Planner Parameters:</strong> Speed limits, acceleration limits, collision avoidance margins.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="344-localization-and-map-management-for-humanoids">3.4.4 Localization and Map Management for Humanoids<a href="#344-localization-and-map-management-for-humanoids" class="hash-link" aria-label="Direct link to 3.4.4 Localization and Map Management for Humanoids" title="Direct link to 3.4.4 Localization and Map Management for Humanoids" translate="no">​</a></h3>
<ul>
<li class=""><strong>Map Server:</strong> Loading static maps (<code>nav2_map_server</code>).</li>
<li class=""><strong>Localization with VSLAM:</strong> Using the pose output from VSLAM (or AMCL) to update the robot&#x27;s position within the global map.</li>
<li class=""><strong><code>robot_localization</code>:</strong> Fusing IMU, odometry, and VSLAM data for a robust state estimate. This is particularly important for humanoid balance.</li>
<li class="">The <code>map</code>, <code>odom</code>, and <code>base_link</code> frames in the context of Nav2.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="345-humanoid-specific-navigation-considerations">3.4.5 Humanoid-Specific Navigation Considerations<a href="#345-humanoid-specific-navigation-considerations" class="hash-link" aria-label="Direct link to 3.4.5 Humanoid-Specific Navigation Considerations" title="Direct link to 3.4.5 Humanoid-Specific Navigation Considerations" translate="no">​</a></h3>
<ul>
<li class=""><strong>Locomotion Model:</strong> Nav2 typically assumes differential drive or omnidirectional robots. Adapting it for bipedal walking is a significant challenge.<!-- -->
<ul>
<li class=""><strong>Solution:</strong> Abstracting the bipedal gait controller as a &quot;locomotion plugin&quot; that takes <code>Twist</code> commands and translates them to joint commands.</li>
</ul>
</li>
<li class=""><strong>Balance and Stability:</strong> Incorporating balance control into velocity commands.</li>
<li class=""><strong>Stairs and Uneven Terrain:</strong> Advanced capabilities beyond basic Nav2.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="346-building-a-nav2-launch-file-and-sending-goals">3.4.6 Building a Nav2 Launch File and Sending Goals<a href="#346-building-a-nav2-launch-file-and-sending-goals" class="hash-link" aria-label="Direct link to 3.4.6 Building a Nav2 Launch File and Sending Goals" title="Direct link to 3.4.6 Building a Nav2 Launch File and Sending Goals" translate="no">​</a></h3>
<ul>
<li class=""><strong><code>nav2_bringup</code>:</strong> Using the provided launch files as a starting point.</li>
<li class=""><strong>Customizing Parameters:</strong> Overriding default parameters in YAML files or directly in the launch file.</li>
<li class=""><strong>Sending Goals:</strong> Using the &quot;2D Goal Pose&quot; tool in RViz2, or programmatically via the <code>nav_to_pose</code> action.</li>
<li class=""><strong>Monitoring Nav2:</strong> Checking logs, <code>ros2 topic echo</code>, and RViz2 visualizations.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="required-diagrams">Required Diagrams<a href="#required-diagrams" class="hash-link" aria-label="Direct link to Required Diagrams" title="Direct link to Required Diagrams" translate="no">​</a></h2>
<ul>
<li class=""><strong>Nav2 Planning Stack:</strong> A block diagram illustrating the flow from localization to global plan, local plan, and velocity commands.</li>
<li class=""><strong>Global vs. Local Costmaps:</strong> A visual representation of how these two costmaps are used by Nav2.</li>
<li class=""><strong>Humanoid Locomotion Abstraction:</strong> A diagram showing how Nav2&#x27;s <code>Twist</code> commands are translated into complex joint movements by a bipedal controller.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="hands-on-labs">Hands-on Labs<a href="#hands-on-labs" class="hash-link" aria-label="Direct link to Hands-on Labs" title="Direct link to Hands-on Labs" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="lab-341-execute-nav2-path-planning-for-a-humanoid-robot">Lab 3.4.1: Execute Nav2 Path Planning for a Humanoid Robot<a href="#lab-341-execute-nav2-path-planning-for-a-humanoid-robot" class="hash-link" aria-label="Direct link to Lab 3.4.1: Execute Nav2 Path Planning for a Humanoid Robot" title="Direct link to Lab 3.4.1: Execute Nav2 Path Planning for a Humanoid Robot" translate="no">​</a></h3>
<p><strong>Objective:</strong> Configure Nav2 to enable autonomous navigation for a simulated humanoid robot in Isaac Sim, using a static map, and send a goal via RViz2.</p>
<p><strong>Prerequisites:</strong> Completed Lab 3.1.1 (Isaac Sim with humanoid), Lab 3.3.1 (VSLAM for localization, or use an equivalent localization source like odometry). A simulated humanoid that can receive <code>geometry_msgs/msg/Twist</code> commands and translate them into bipedal motion (this requires a simple gait controller, which will be simplified for this lab).</p>
<p><strong>Instructions:</strong></p>
<ol>
<li class="">
<p><strong>Prepare a Simplified Humanoid for Nav2:</strong></p>
<ul>
<li class="">
<p>For this lab, we will <em>abstract</em> the humanoid&#x27;s bipedal locomotion. Instead of complex gait, assume a simple <code>cmd_vel</code> to base_link motion. This is a common simplification for initial Nav2 integration.</p>
</li>
<li class="">
<p><strong>Create a <code>humanoid_cmd_vel_converter</code> node (Python):</strong> This node will subscribe to <code>/cmd_vel</code> (output from Nav2) and print/log the velocity commands. In a real system, this would translate <code>cmd_vel</code> into joint commands for the bipedal gait.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &lt;your_ros2_ws&gt;/src/humanoid_nav_utils/humanoid_nav_utils/cmd_vel_converter.py</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> rclpy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> rclpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">node </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> Node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> geometry_msgs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">msg </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> Twist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">HumanoidCmdVelConverter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">__init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin" style="color:rgb(130, 170, 255)">super</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;humanoid_cmd_vel_converter&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">subscription </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">create_subscription</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Twist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;/cmd_vel&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">cmd_vel_callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get_logger</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Humanoid Cmd Vel Converter Node started. Waiting for /cmd_vel...&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">cmd_vel_callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Twist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get_logger</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&#x27;Received /cmd_vel: Linear X=</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">msg</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">linear</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">x</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token string-interpolation interpolation format-spec">.2f</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">, Angular Z=</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">msg</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">angular</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">z</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token string-interpolation interpolation format-spec">.2f</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># In a real system, this is where you&#x27;d translate Twist to joint commands for bipedal gait</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># For this lab, we just log.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># You could also use a ros_gz_sim plugin for directly controlling the humanoid model&#x27;s base link</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># if your Isaac Sim humanoid model can be controlled via external forces or velocities.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">args</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rclpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">init</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">args</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    node </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> HumanoidCmdVelConverter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rclpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">spin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">destroy_node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rclpy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">shutdown</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<p>Create a new package <code>humanoid_nav_utils</code> and add this node, then build it.</p>
</li>
</ul>
</li>
<li class="">
<p><strong>Generate a Map:</strong></p>
<ul>
<li class="">For simplicity, we&#x27;ll use a pre-existing map or create a simple one from a simulated environment. If you have run VSLAM in a simple environment, you can save its map.</li>
<li class="">Alternatively, in Isaac Sim, create a simple room with walls and export it as an image. Use <code>ros2 run nav2_map_server map_saver_cli -f map_name</code> in a terminal <em>after</em> building a map with VSLAM/SLAM. For this lab, assume you have a <code>map.yaml</code> and <code>map.pgm</code> (e.g., in <code>humanoid_nav_utils/maps</code> folder).</li>
</ul>
</li>
<li class="">
<p><strong>Prepare Nav2 Configuration Files:</strong></p>
<ul>
<li class="">Nav2 requires several YAML configuration files. Copy example configs from <code>nav2_bringup/params/nav2_params.yaml</code> and customize them for your humanoid robot.</li>
<li class="">Key parameters to adjust:<!-- -->
<ul>
<li class=""><code>robot_radius</code>: Set based on your humanoid&#x27;s footprint.</li>
<li class=""><code>controller_server</code>: PID gains, speed limits (for <code>cmd_vel</code> output).</li>
<li class=""><code>planner_server</code>: Planner type, costmap resolution.</li>
<li class=""><code>local_costmap</code>, <code>global_costmap</code>: Sensor sources (e.g., <code>/simple_humanoid/lidar/scan</code> if using your simulated LiDAR).</li>
<li class=""><code>transform_tolerance</code>: Time tolerance for TF2 lookups.</li>
</ul>
</li>
<li class="">Store these in <code>humanoid_nav_utils/params</code>.</li>
</ul>
</li>
<li class="">
<p><strong>Create a Nav2 Launch File (<code>humanoid_nav2_bringup.launch.py</code>):</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> ament_index_python</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">packages </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> get_package_share_directory</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> launch </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> LaunchDescription</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> launch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">actions </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> IncludeLaunchDescription</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> DeclareLaunchArgument</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> launch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">launch_description_sources </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> PythonLaunchDescriptionSource</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> launch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">substitutions </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> LaunchConfiguration</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PathJoinSubstitution</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> launch_ros</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">actions </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> Node</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> nav2_common</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">launch </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> RewrittenYaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">generate_launch_description</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ld </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> LaunchDescription</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Declare arguments</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    map_yaml_file </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> LaunchConfiguration</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;map_yaml_file&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    params_file </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> LaunchConfiguration</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;params_file&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    use_sim_time </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> LaunchConfiguration</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;use_sim_time&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    declare_map_yaml_cmd </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> DeclareLaunchArgument</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;map_yaml_file&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        default_value</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">os</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">join</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">get_package_share_directory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;humanoid_nav_utils&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;maps&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;my_simple_map.yaml&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Replace with your map</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        description</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Full path to map file to load&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    declare_params_file_cmd </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> DeclareLaunchArgument</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;params_file&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        default_value</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">os</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">join</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">get_package_share_directory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;humanoid_nav_utils&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;params&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;humanoid_nav2_params.yaml&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Replace with your params</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        description</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Full path to param file to load&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    declare_use_sim_time_cmd </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> DeclareLaunchArgument</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;use_sim_time&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        default_value</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;True&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        description</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;Use simulation (Gazebo/Isaac Sim) clock if true&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Rewritten YAML for parameter substitution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Replace &#x27;/odom&#x27; with &#x27;/simple_humanoid/odom&#x27; if your odom topic is namespaced</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Also adjust for your lidar topic if it&#x27;s different.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    param_substitutions </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;use_sim_time&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> use_sim_time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &#x27;global_costmap.global_costmap.ros__parameters.scan.topic&#x27;: &#x27;/simple_humanoid/lidar/scan&#x27;, # Example if needed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &#x27;local_costmap.local_costmap.ros__parameters.scan.topic&#x27;: &#x27;/simple_humanoid/lidar/scan&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    configured_params </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> RewrittenYaml</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        source_file</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">params_file</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        root_key</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        param_rewrites</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">param_substitutions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        convert_types</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Nav2 Bringup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    nav2_bringup_launch </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> IncludeLaunchDescription</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        PythonLaunchDescriptionSource</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">os</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">join</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            get_package_share_directory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;nav2_bringup&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;launch&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;bringup_launch.py&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        launch_arguments</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;map&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> map_yaml_file</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;use_sim_time&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> use_sim_time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;params_file&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> configured_params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;autostart&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;true&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;namespace&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># No namespace for this simple example</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">items</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Add our humanoid_cmd_vel_converter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    cmd_vel_converter_node </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        package</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;humanoid_nav_utils&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Assuming this package exists</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        executable</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;cmd_vel_converter&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;humanoid_cmd_vel_converter&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        output</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;screen&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        parameters</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;use_sim_time&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> use_sim_time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># RViz2 Node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Use a default Nav2 RViz config or create a custom one</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rviz_config_file </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">join</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">get_package_share_directory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;nav2_bringup&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;rviz&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;nav2_default_view.rviz&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    rviz_node </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> Node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        package</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;rviz2&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        executable</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;rviz2&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;rviz2&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        output</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;screen&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        arguments</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;-d&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> rviz_config_file</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        parameters</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;use_sim_time&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> use_sim_time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ld</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">add_action</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">declare_map_yaml_cmd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ld</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">add_action</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">declare_params_file_cmd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ld</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">add_action</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">declare_use_sim_time_cmd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ld</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">add_action</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">nav2_bringup_launch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ld</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">add_action</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">cmd_vel_converter_node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ld</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">add_action</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">rviz_node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> ld</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>Build your <code>humanoid_nav_utils</code> package and source your workspace:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cd &lt;your_ros2_ws&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">colcon build --packages-select humanoid_nav_utils nav2_bringup # Ensure nav2_bringup is built</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">source install/setup.bash</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>Launch Isaac Sim with your humanoid (e.g., from <code>display_humanoid.launch.py</code>).</strong> Ensure it publishes <code>/tf</code> from <code>odom</code> to <code>base_link</code> and sensor data (e.g., <code>/simple_humanoid/lidar/scan</code>).</p>
</li>
<li class="">
<p><strong>In a separate terminal, launch Nav2:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ros2 launch humanoid_nav_utils humanoid_nav2_bringup.launch.py</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>In RViz2:</strong></p>
<ul>
<li class="">Set the &quot;Fixed Frame&quot; to <code>map</code>.</li>
<li class="">Use the &quot;2D Pose Estimate&quot; tool to give Nav2 an initial pose (click on the map where your robot is).</li>
<li class="">Use the &quot;2D Goal Pose&quot; tool to set a navigation goal.</li>
<li class="">Observe Nav2 planning a path (global and local) and publishing <code>cmd_vel</code> messages, which should be logged by your <code>humanoid_cmd_vel_converter</code>.</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="expected-output">Expected Output<a href="#expected-output" class="hash-link" aria-label="Direct link to Expected Output" title="Direct link to Expected Output" translate="no">​</a></h2>
<ul>
<li class="">A running Nav2 stack in conjunction with your simulated humanoid in Isaac Sim.</li>
<li class="">Nav2 successfully planning a global path from the robot&#x27;s current pose to a given goal.</li>
<li class="">Nav2 publishing <code>geometry_msgs/msg/Twist</code> commands to guide the robot along the path.</li>
<li class="">Visualization of global and local paths, costmaps, and the robot&#x27;s pose in RViz2.</li>
<li class="">Understanding of the core components of Nav2 and their interaction in a navigation task.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="assessment-questions">Assessment Questions<a href="#assessment-questions" class="hash-link" aria-label="Direct link to Assessment Questions" title="Direct link to Assessment Questions" translate="no">​</a></h2>
<ul>
<li class="">Explain the difference in responsibilities between a global planner and a local planner within the Nav2 stack.</li>
<li class="">How would you adapt Nav2&#x27;s typical configuration (designed for wheeled robots) to better suit a bipedal humanoid robot, considering it can&#x27;t simply rotate in place?</li>
<li class="">What is a costmap in Nav2, and why are there typically two (global and local)?</li>
<li class="">Describe the steps involved in sending a navigation goal to Nav2, either through RViz2 or programmatically.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="real-world-applications">Real-world Applications<a href="#real-world-applications" class="hash-link" aria-label="Direct link to Real-world Applications" title="Direct link to Real-world Applications" translate="no">​</a></h2>
<ul>
<li class=""><strong>Autonomous Patrols:</strong> Humanoid security robots navigating complex indoor environments to monitor premises.</li>
<li class=""><strong>Assistance in Homes/Offices:</strong> Humanoid helper robots moving between rooms, avoiding obstacles, and reaching specific locations to perform tasks.</li>
<li class=""><strong>Disaster Response:</strong> Humanoid robots navigating hazardous, unstructured terrain to inspect damage or assist in search and rescue operations.</li>
<li class=""><strong>Logistics and Warehousing:</strong> Humanoid robots transporting items or performing tasks requiring movement in human-centric industrial settings.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="edge-cases">Edge Cases<a href="#edge-cases" class="hash-link" aria-label="Direct link to Edge Cases" title="Direct link to Edge Cases" translate="no">​</a></h2>
<ul>
<li class=""><strong>Unreachable Goals:</strong> Nav2 will fail if the goal is inside an obstacle or is in an area that the robot cannot reach.</li>
<li class=""><strong>Dynamic Obstacles:</strong> While local planners can handle some dynamic obstacles, very fast or unpredictable moving obstacles can cause the robot to get stuck or collide.</li>
<li class=""><strong>Poor Localization:</strong> Errors in the VSLAM (or other localization source) will lead to Nav2 planning paths based on an incorrect robot position, potentially causing collisions.</li>
<li class=""><strong>Humanoid Gait Controller Limitations:</strong> If the <code>cmd_vel_converter</code> (bipedal gait controller) cannot accurately translate Nav2&#x27;s desired <code>Twist</code> into stable humanoid motion, the robot may fall or fail to reach its goal.</li>
</ul>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="key-entities"><strong>Key Entities</strong><a href="#key-entities" class="hash-link" aria-label="Direct link to key-entities" title="Direct link to key-entities" translate="no">​</a></h3>
<ul>
<li class=""><strong>Nav2 (Navigation2):</strong> The ROS 2 framework for autonomous mobile robot navigation, providing capabilities for global path planning, local control, and recovery behaviors.</li>
<li class=""><strong>Global Planner:</strong> A component of Nav2 responsible for calculating an overall, long-term path from the robot&#x27;s start to its goal, considering a global map and known obstacles.</li>
<li class=""><strong>Local Planner (Controller):</strong> A component of Nav2 that generates short-term, dynamically feasible velocity commands (<code>geometry_msgs/msg/Twist</code>) to follow the global path while avoiding immediate, potentially dynamic, obstacles.</li>
<li class=""><strong>Costmap:</strong> A 2D grid-based map used by Nav2 to represent the traversability of the environment, incorporating information about static obstacles, dynamic obstacles, and inflation layers.</li>
<li class=""><strong><code>nav_to_pose</code> Action:</strong> The ROS 2 action interface used to send navigation goals to the Nav2 stack, enabling a robot to autonomously move to a specified pose.</li>
<li class=""><strong><code>robot_localization</code>:</strong> A meta-package that provides advanced state estimation capabilities, fusing data from multiple sensors (e.g., IMU, odometry, VSLAM) to produce a more accurate and robust pose estimate for Nav2.</li>
<li class=""><strong><code>cmd_vel</code> Topic:</strong> The standard ROS 2 topic (publishing <code>geometry_msgs/msg/Twist</code> messages) where navigation controllers output desired linear and angular velocities for the robot.</li>
<li class=""><strong>Waypoint Navigation:</strong> The process of guiding a robot through a series of intermediate points (waypoints) to reach a final destination, often used for complex missions.</li>
</ul>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="references"><strong>References</strong><a href="#references" class="hash-link" aria-label="Direct link to references" title="Direct link to references" translate="no">​</a></h3>
<ul>
<li class="">Macenski, S., et al. (2020). The ROS 2 Navigation Stack: Design Decisions and Future Work. <em>International Conference on Robotics and Automation (ICRA) Workshop</em>. (Placeholder citation)</li>
<li class="">Open Robotics. (n.d.). <em>Nav2 Documentation</em>. (Placeholder citation)</li>
<li class="">Arkin, R. C. (1998). <em>Behavior-Based Robotics</em>. MIT Press. (Placeholder citation)</li>
<li class="">Kuipers, B. (2000). The spatial semantic hierarchy. <em>Artificial Intelligence, 119</em>(1-2), 191-233. (Placeholder citation)</li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/Book-Hackathon-physical-ai-humanoid/module-3/perception-isaac-ros-vslam/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">3.3 Perception with Isaac ROS (VSLAM)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Book-Hackathon-physical-ai-humanoid/module-3/training-robot-policies/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">3.5 Training Robot Policies</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#goal" class="table-of-contents__link toc-highlight">Goal</a></li><li><a href="#learning-objectives" class="table-of-contents__link toc-highlight">Learning Objectives</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#key-concepts" class="table-of-contents__link toc-highlight">Key Concepts</a></li><li><a href="#tools" class="table-of-contents__link toc-highlight">Tools</a></li><li><a href="#chapter-sections" class="table-of-contents__link toc-highlight">Chapter Sections</a><ul><li><a href="#341-overview-of-the-nav2-navigation-stack" class="table-of-contents__link toc-highlight">3.4.1 Overview of the Nav2 Navigation Stack</a></li><li><a href="#342-global-planning-finding-the-route" class="table-of-contents__link toc-highlight">3.4.2 Global Planning: Finding the Route</a></li><li><a href="#343-local-planning-following-the-path-and-avoiding-obstacles" class="table-of-contents__link toc-highlight">3.4.3 Local Planning: Following the Path and Avoiding Obstacles</a></li><li><a href="#344-localization-and-map-management-for-humanoids" class="table-of-contents__link toc-highlight">3.4.4 Localization and Map Management for Humanoids</a></li><li><a href="#345-humanoid-specific-navigation-considerations" class="table-of-contents__link toc-highlight">3.4.5 Humanoid-Specific Navigation Considerations</a></li><li><a href="#346-building-a-nav2-launch-file-and-sending-goals" class="table-of-contents__link toc-highlight">3.4.6 Building a Nav2 Launch File and Sending Goals</a></li></ul></li><li><a href="#required-diagrams" class="table-of-contents__link toc-highlight">Required Diagrams</a></li><li><a href="#hands-on-labs" class="table-of-contents__link toc-highlight">Hands-on Labs</a><ul><li><a href="#lab-341-execute-nav2-path-planning-for-a-humanoid-robot" class="table-of-contents__link toc-highlight">Lab 3.4.1: Execute Nav2 Path Planning for a Humanoid Robot</a></li></ul></li><li><a href="#expected-output" class="table-of-contents__link toc-highlight">Expected Output</a></li><li><a href="#assessment-questions" class="table-of-contents__link toc-highlight">Assessment Questions</a></li><li><a href="#real-world-applications" class="table-of-contents__link toc-highlight">Real-world Applications</a></li><li><a href="#edge-cases" class="table-of-contents__link toc-highlight">Edge Cases</a><ul><li><a href="#key-entities" class="table-of-contents__link toc-highlight"><strong>Key Entities</strong></a></li><li><a href="#references" class="table-of-contents__link toc-highlight"><strong>References</strong></a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>